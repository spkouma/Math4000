\documentclass[10pt,letterpaper]{article}
\usepackage[scale=0.7]{geometry}
\usepackage[version=3]{mhchem} 
\usepackage[english]{babel}
\usepackage{chemfig}
\newcommand{\species}[1]{\textit{#1} sp.}
\usepackage{subcaption}
\newcommand{\leng}{\mathcal{L}}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[english]{babel}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{subcaption}
\usepackage{cancel}
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

%
% \newcommand{\species}[1]{\textit{#1} sp.}
\newcommand{\nads}[1]{
    \ensuremath{
        \frac{
            n_{surf}
        }{
            #1
        }
    }
}
%
\newcommand{\nlp}[1]{
    \ensuremath{
        r
        -
        \nads{#1}
    }
}
%
\newcommand{\stirl}[1]{
    \ensuremath{
        \left(
            #1
        \right)
        \cdotp 
        log
        \left[
            \left(
            #1
            \right)
        \right]
        -
        \left(
            #1
        \right)
    }
}
%
\newcommand{\stirlBraces}[1]{
    \ensuremath{
        \left\{
            \left(
                #1
            \right)
            \cdotp 
            log
            \left[
            \left(
                #1
            \right)
            \right]
            -
            \left(
                #1
            \right)
        \right\}
    }
}
%
\newcommand{\logOFgOFm}[1]{
	\ensuremath{
	#1
	\cdot
	\left\{
    	log
    	\left[
    	    \left(
    	        \nads{#1}
    	    \right)!
    	\right]
    	-
    	log
    	\left[
        	\left(
        	    \nlp{#1}
        	\right)!
    	\right]
    	-
    	log
    	\left[
    	    \left(
        	    2
        	    \cdot
        	    \nads{#1}
        	    -
        	    r
            \right)!
    	\right]
	\right\}
	}
}
%\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000
%
\newcommand{\StirlOFgOFm}[1]{
	\ensuremath{
	#1
	\cdot
	\left\{
    	stirl
    	\left[
    	        \nads{#1}
    	\right]
    	-
    	stirl
    	\left[
        	    \nlp{#1}
    	\right]
    	-
    	stirl
    	\left[
        	    2
        	    \cdot
        	    \nads{#1}
        	    -
        	    r
    	\right]
	\right\}
	}
}
%
\newcommand{\myQ}[5]{
	\ensuremath{	
%		Q
%		\left(#1,#2 \right)=
		n!
		\left(
		\left(
		A_2
		\right)^{#1}
		\cdot 
		\mu_{2}^{n_{surf}} 
		\cdot 
		#5
		\cdot
		\frac{
		        n_{surf}^{#1}
		    }{
		        #1!
		    }
		\cdot
		\left(
		    A_3
		\right)^{#2}
		\cdot 
		\left(
		    \mu_{3}
		\right)^{r\cdotp #2}
		\cdot
		\frac{
			n_{vol}^{#2}
		}{
			#2!
		}
		\right)
		}
}
%
%
\newcommand{\gOFm}[2]{
\left( \frac{
\left(\frac{#2}{#1}\right)!}{ 
\left(r-\frac{#2}{#1}\right)! 
\left(2\frac{#2}{#1}-r\right)!}
\right)^{#1}  
}
%
%\usepackage[superscript]{cite}
\title{Adsorption of Polyelectrolytes to a Spherical Colloid Surface with Loop Considerations}
\author{Spyros Koumarianos}
\date{\today}
	


\begin{document}
\maketitle

\newpage

\section*{Introduction}
\noindent \textcolor{red}{[proper intro paragraph needed]}\\

\noindent \textcolor{red}{[background]}\\

Motivation of this analysis is that of continuing down the pathway of devising an even more realistic model for the conformational modelling of polymer chains on a spheroid surface. \textcolor{red}{[more]}

We first define the  terms trains, tails and loops, as this information will be vital in our analysis. Trains are the polymer segments that are adsorbed onto a surface, loops are the  desorbed segments separated by two trains while tails are the desorbed end segments. In the rest of report tails will not be considered. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{Clipboard.png}
	\caption{Illustration of trains,tails, loops \cite{fleer1993polymers}}
	\label{fig:gull}
\end{figure}



\section*{Modelling Setup}

In this model we assume a fixed loop length and compare the cardinality of configuration sets of 3 different chain lengths individually. We will essentially be computing this cardinality for multiple scenarios of coverage from initial scenario being of full coverage with no loops. The consecutive scenarios being of adding additional chains to the surface,which is done iteratively for more and more chains adsorbed and thus more and more loops generated, all the way up to the scenario where there is zero (or minimal) existence of trains of more than 1 mer (this of course will largely depend on the number of mers per chain and if they can properly be broken up and the decision of the length of our fixed loop). We will finally compare the results of the three different chain lengths in terms of contribution based on cardinality of configurations with the consideration of loops. The ultimate goal is to compile a framework that then can be used, where one would sample multiple different loop lengths and have the model test each one individually and then combine the results. This method essentially teases out the complexity of Fleer's more universal approach, by means of a more iterative process, with simpler approximations, and thus better compatibility with a low-power computational environment.

We start by stating that our model will be that of a polymer chain attaching to a spherical lattice \textcolor{red}{[more, is that really our model??]}. We then assumme for ease of computation and geometrical analysis [needs more focused terminology], that the surface of the sphere can be approximated to a square lattice with the same number of single mer sites. In our report this will be notated as $n_{surf}$. 

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\includegraphics[scale=0.15]{latticeMid.pdf}
		\caption{          }
		\label{fig:gull}	
	\end{subfigure}
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[scale=0.45]{squarelatticeMid.pdf}
		\caption{       }
		\label{fig:gull}	
	\end{subfigure}
	\caption{Approximation of (a) sphere to (b) square lattice}
\end{figure}




\section*{Modelling Approach}

\noindent Given each of the scenarios we compare the output of available loops and in turn configurations for Long (6200mers), Arbitrary Midlength (3100mers), Short (27mers) respectively.

%if I will use this I need to fix up the dimensions
% \begin{tabular}{c|c|c}

% 	Scenario;  & How Many Available Combinations? & Largest Contribution? \\ 
% 	\hline
% 	full coverage, no loops & $\mathcal{E}_{L}$, $\mathcal{E}_{M}$, $\mathcal{E}_{L}$? & L,M or S?\\ 
% 	scenario with one more chain added & \vdots & \vdots\\
% 	scenario with 2 chains added &  \vdots & \vdots\\
% 	\vdots & \vdots & \vdots\\
% 	scenario with 2 chains added & \vdots & \vdots\\
% 	\hline 
% \end{tabular}


\noindent In essence, if we were to hypothesize the scenario of "squeezing" an additional chain, we inspect how the other chains on the surface would need to be rearranged and loop to accommodate this addition. Finally, after calculating the number of ways they could be rearranged, we ask if given this quantity of configurations if this would be a preferable scenario.

\section*{Model Approximation}
We proceed with a hybrid of Fleer \cite{fleer1993polymers} and of our very own Long-Short approach. We start by observing the case with full (no loops), in order to understand the entropy when no loops exist. Then we proceed to the novel portion, of comparing the configurations when an additional chain is on the surface, and calculate how many loops, and where theses loops could be generated and in how many ways could the loops and the chains be arranged. Then we do the same when one more chain than the prior scenario, is on the surface and compare our results to the prior scenario. In this first order approach we shall assume loops of length one mer, $s_{lp}=1$. We also assume the site below the loop is occupied by one of the adjacent trains, resulting from the restricted walks, after the formation of the loop.


\begin{figure}[h!]
	\centering
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[scale=0.2]{loop1_trains.png}
		\caption{All chains with loops of length one mer and arbitrary trains}
		\label{loop and train}
	\end{subfigure}~~~~~~~~~~~~
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[scale=0.2]{loop1.png}
		\caption{All chains with loops of length one mer and trains of one mer}
		\label{loop}
	\end{subfigure}
	\caption{Modelling Approach with fixed looplength}
\end{figure}


\noindent Prior to proceeding to the notational descriptions, let us first understand an illustration of the model. Essentially, one can imagine a 3 dimensional tetris game where the only difference is that all chains will be dropped simultaneously and we have the additional option of generating loops on the chains (our tetris pieces) for a set amount of supplementary chain segments, given the amount of chains we are attempting to drop.\\

\noindent We begin by establishing a formalisation of the model in describing the notational framework. The setup is that of multiple adsorbed chains of same length. We begin by making the assumption that the number of adsorbed sites is same for each chain, and we don't have clustering effects [check]. From Fleer \cite{fleer1993polymers} we have adopted the following notation (refer to Appendix?). The number of mers per chain (chainlength) is $\mathbf{r}$. The fixed length of loops on an adsorbed chain enumerated in units of single mer sites, is notated by, $\mathbf{s_{lp}}$, the number of loops, on the adsorbed chain, which will also be in units of single mer sites, is $\mathbf{n_{lp}}$. Additionally, $\mathbf{n_a}$  is the number of chains on the surface and $\mathbf{n_b}$ number of chains in solution, counted in number of chains. Finally, $\mathbf{q_{ch}}$ is the notation for the partition function of one adsorbed chain.\\


\noindent We proceed to define our own notational framework below. We let $n_{surf}$ be the total available surface sites.

\begin{equation}
	\boxed{n_{surf}=n_{ads}\cdotp n_{a}}
	\label{nsurf}
\end{equation}

\noindent We assume the following conditions for our model.

$$
\boxed{
    \left. %this is a delimiter
        \begin{array}{ll}
            \text{Number of total sites on surface:} & n_{surf}\\
            \text{Length of each chain:}& r\\
        \end{array}
    \right\}
    \rightarrow\text{FIXED}
}
$$




\noindent Given the above, we define the number of adsorbed sites, in mers per, chain (on average) as,

\begin{equation}
	\boxed{n_{ads}:= \frac{n_{surf}}{n_a}}
	\label{nads}
\end{equation}


\noindent Let $n_{lp}$ be the number of sites in all loops 
in one chain (on average).

\begin{equation}
	\boxed{\bar{n}_{lp}:=r-\frac{n_{surf}}{n_a}}
	\label{mean nlp}
\end{equation}


\noindent The number of loops per 
chain is calculated through,


\begin{equation}
	\boxed{n_{lp}:= \frac{r-\frac{n_{surf}}{n_a}}{s_{lp}}}
	\label{nlp,Gen}
\end{equation}


\noindent And if we let loop size $s_{lp}=1$, then,


\begin{equation}
\boxed{n_{lp}:= r-\frac{n_{surf}}{n_a}}
\label{nlp}
\end{equation}

%$$ \therefore \text{Number of trains}, n_{tr}:=r-n_{lp}=r- \frac{r-\frac{V_m}{n_a}}{s_{lp}}$$
%
%$$\Rightarrow \boxed{n_{tr}:=\frac{r(s_{slp}-1)-\frac{V_m}{n_a}}{s_{lp}}}$$











% \noindent loops per chain.   [***NM:  \textit{Delete these three words?}***] \\\\


\noindent Relation \ref{nonRev} is a treatment %that essentially "places" the polymers in a dense
%[***NM:  \textit{it is not specific to ``dense''
%situations; indeed, it is better in the less dense 
%situation}***]
% packing environment and thus 
where each additional chain placement further restricts the configurations for the successive "placements". 

\begin{equation}
    \boxed{
	    \text{non reversing walks:  } q(q-1)^{(\#steps-1)}
	 }
	\label{nonRev}
\end{equation}

\noindent Relation \ref{selfAv} is a treatment that essentially "places" the polymers in a sparse packing environment and thus each additional chain placement has no effect on the available configurations for the succesive "placements".

\begin{equation}
    \boxed{
	    \text{self avoiding walks:  } \approx A_i\cdot\mu_i^{(\#steps)}.
    }
	\label{selfAv}
\end{equation}

\noindent We proceed with using the approach of relation \ref{selfAv}, which is that of Self Avoiding Walks as a simpler approach as a first order method. Here $\mu_i$ and $A_i$ depend on the choice of lattice\cite{Chen2002,Madras2013}. where $i$ refers to the dimension of the lattice, which in the analysis below will be focused on 2 and 3 dimensions.


\noindent So for one chain we want to see where the looping will take place. We have devised a treatment such that the loops will always be atop two adsorbed mers, and it can be observed in Figure 2b, that the looping is in Loop Choice 2, as per the nomenclature of Figure 2c.

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{0.65\textwidth}
		\centering
		\includegraphics[scale=0.4]{loopnorm.png}
		\caption{Looping with an unoccupied site below the looping}
		\label{loop and train}
		\end{subfigure}\\
		\begin{subfigure}[b]{0.7\textwidth}
			\centering
			\includegraphics[scale=0.4]{loopsquished.pdf}
			\caption{convention of the model, no unoccupied spaces below the loop}
			\label{loop and train}
		\end{subfigure}\\
		\begin{subfigure}[b]{0.75\textwidth}
			\centering
			\includegraphics[scale=0.45]{loopschoices.png}
			\caption{visualization of the binomial coefficient of this modelling treatment}
			\label{loop}
	\end{subfigure}
	\caption{Modelling Approach with fixed looplength}
\end{figure}

\noindent In order to better understand the enumeration scheme of given a set choices for an arbitrary number of loops for a fixed loop length we devised the following graphic below (Figure \ref{arbChoice}).

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{0.6\textwidth}
		\centering
		\includegraphics[scale=0.6]{multiloops.png}
		\caption{arbitrary looping on arbitrary chain length}
		\label{loop and train}
	\end{subfigure}\\
	\begin{subfigure}[b]{1.0\textwidth}
		\centering
		\includegraphics[scale=0.35]{LoopingGraphic.pdf}
		\caption{visualization of the binomial coefficient of chain}
		\label{loop and train}		
	\end{subfigure}
\caption{Scenario with an arbitrary $n_{lp}$}
\label{arbChoice}
\end{figure}



\noindent We Proceed with \ref{selfAv} and multiply this with the number of ways to lay down each chain, which yields the following general relations for 2D and 3D respectively.\\ 


\noindent So for 2D, we have $q_{2,ch}$ which is
the number of ways to lay one chain on the surface, for a given starting point,

\begin{equation}
    \boxed{
    	q_{2,ch}\approx \left(A_2\cdot (\mu_{2})^{n_{ads}} \cdot \binom{n_{ads}}{n_{lp}} \right), 
    }
	\label{eq. q2}
\end{equation}

%explain sourcing of this...
\noindent and for 3D, 

%had put r-1 initially but then corrected as per statement from madras r x nb as opposed to ()r-1) x nb
\begin{equation}
    \boxed{
	    q_{3,ch}\approx \left(A_3\cdot (\mu_{3})^{r}\right).
	}
	\label{eq. q3}
\end{equation}



%\noindent To understand this better, if we have 2 loops for an adsorbed chain then we have r-2 sites adsorbed and r-n_{ads} places where loop could go on a walk of r-2 sites. 
%
%$$\text{for LP=2,~~~~} q_{tr}\approx A\cdot \mu_{2}^{r-n_{ads}} \cdot \binom{r-n_{ads}}{2}$$




\noindent Here we have adapted Fleer's approximation, 
%\footnote{this approach does not take into account high density surface coverage, but will be further adapted in higher order approximations.} 
%
and we neglect the energetic factor as well as the interactions, that were incorporated by Fleer based on seperate works by Hoeve \cite{hoeve1970general}  and Silberberg \cite{silberberg1968adsorption}.\\\\

\noindent Where, the total number of polymers in the whole system are,
\begin{equation}
	n=n_a+n_b,
	\label{eq. n}
\end{equation}

\noindent And the partition function for a system of multiple polymers is,
%[***NM: \textit{I thnk that the term $n!$ in $Q$ is there because $Q$ is counting the number of configurations of $n$ LABELLED chains, i.e.\ all formally distinct from each other, even though they are identical. You should eventually explain why the whole expression for $Q$ is what it is}***]



\begin{equation}
	Q=
	n!
	\left(
		q_{2,ch}^{n_{a}}
		\cdot
		\frac{
			n_{surf}^{n_{a}}
		}{
			n_a!
		}
		\cdot
		q_{3,ch}^{n_{b}}
		\cdot
		\frac{
			n_{vol}^{n_{b}}
		}{
			n_b!
		}
	\right)
	\label{Qfleer}
\end{equation}

\noindent Substituting \ref{eq. q2} and \ref{eq. q3} into \ref{Qfleer}.

\begin{equation}
	Q(n_a,n_b)=
	n!
	\left(~~
		\left(
		A_2
		\cdot 
		\mu_{2}^{n_{ads}}
		\cdot 
		\binom{
			n_{ads}
		}{
			n_{lp}
		}
		\right)^{n_{a}} 
		\cdot
		\frac{
			n_{surf}^{n_{a}}
		}{
			n_a!
		}
		\cdot
		\left(
			A_3
			\cdot
			\left(
				\mu_{3}
			\right)^{r}
		\right)^{n_{b}}
		\cdot
		\frac{
			n_{vol}^{n_{b}}
		}{
			n_b!
		}
	\right)
	\label{Qmadras}
\end{equation}

\noindent Substituting \ref{nsurf} into \ref{Qmadras}.

\begin{equation}
	Q(n_a,n_b)=
	n!
	\left(
		A_2^{n_{a}}
		\cdot 
		\mu_{2}^{n_{surf}} 
		\cdot 
		\binom{
			n_{ads}
		}{
			n_{lp}
		}^{n_{a}}
		\cdot
		\frac{
			n_{surf}^{n_{a}}
		}{
			n_a!
		}
		\cdot
		\left(
		A_3
		\cdot
		(\mu_{3})^{r}
	\right)^{n_{b}}
	\cdot
	\frac{
		n_{vol}^{n_{b}}
	}{
		n_b!
	}
	\right)
	\label{Qwithnsurf}
\end{equation}

\noindent Substituting \ref{nlp} and \ref{nads} into \ref{Qwithnsurf}
%
%[***NM:  \textit{Is this the right equation number?}] 
%
with $s_{lp}=1$

\begin{equation}
	Q(n_a,n_b)=\myQ{n_a}{n_b}{\nads{n_a}}{(\nlp{n_a})}{\gOFm{n_a}{n_{surf}}}
	\label{eq. Qab}
\end{equation}

\noindent We define relation \ref{gOFm}, for ease of symbolic manipulations.

\begin{equation}
    \boxed{g(m):= \gOFm{m}{n_{surf}}}
    \label{gOFm}
\end{equation}


\noindent Comparing $Q(n_a+1,n_b-1)$ and $Q(n_a,n_b)$ so we let,

\begin{equation}
    \boxed{f(n_a,n_b):=\frac{Q(n_a+1,n_b-1)}{Q(n_a,n_b)}}
    \label{QfracDEF}
\end{equation}


\begin{equation}
f(n_a,n_b)=
	\frac{
		\myQ{(n_a+1)}{(n_b-1)}{\nads{n_a+1}}{(\nlp{n_a+1})}{g(n_a+1)}
	}{
		\myQ{n_a}{n_b}{\nads{n_a}}{(\nlp{n_a})}{g(n_a)}
	}
	\label{eq. Qratio2}
\end{equation}
\text{}\\

%  [***NM: \textit{say that you define $f(n_a,n_b)$ to be $Q(n_a+1,n_b-1)/Q(n_a,n_b)$}***]
\noindent Simplifications lead to the following function of $n_a,n_b$


\begin{equation}
f(n_a,n_b)=\,
\left(
    A_2
\right)
\cdotp
\left(
	\frac{
		g(n_a+1)
	}{
		g(n_a)
	}
\right)
\cdotp
\left(
    \frac{
    	n_{surf}
    }{
    	n_a+1
    }
\right)
\cdotp
\left(
    \frac{
    	1
    }{
    	\mu_{3}
    }
    \right)^r
\cdot
\left(
    \frac{
        1
    }{
        A_3
    }
\right)
\cdot
\left(
    \frac{
    	n_{b}
    }{
    	n_{vol}	
    } 
\right)
\label{fnanb}
\end{equation}



% [***NM:  \textit{The above expression for $f$ has several errors.  First, $A_3$ should be $1/A_3$. 
% Second, $\mu_3$ should be raised to the power $r$.   
% Finally, you did too much cancellation in the big ratio of factorials.  In (\ref{eq. Qratio2}),you have (big fraction 1)$^{n_a+1}$/(big fraction 2)$^{n_a}$.  You seem to have just cancelled the $()^{n_b}$ terms to be left with (big fraction 1)$^1$. However, (big fraction 1) is different from (big fraction 2). So they don't simply cancel.  Here is a way to deal with these big fractions.  
% Define \[ g(m)=  \left( \frac{
% \left(\frac{n_{surf}}{m}\right)!}{ 
% \left(r-\frac{n_{surf}}{m}\right)! 
% \left(2\frac{n_{surf}}{m}-r\right)!}
% \right)^m  
% \]
% Then you can use the Stirling approximation to get a 
% simpler expression for $\log g(m)$.}***]


\text{}\\
\noindent Taking the logarithm of the above function, and employing the stirling approximation method (rel. \ref{stirl}) for the logarithms of factorials. We get relation \ref{logf}

\begin{equation}
	\boxed{stirl[x]:=\stirl{x}}
	\label{stirl}
\end{equation}


\begin{multline}
	log
	\left[
	f(n_a,n_b)
	\right]
	=
	log
		\left[
		A_2
		\right]
		+
		log\left[
            g(n_a+1)
        \right]
        -
        log\left[
            g(n_a)
        \right]
		+
		log
		\left[
		n_{surf}
		\right]
		-
		log
		\left[
		n_a+1
		\right]\\
		-
		r
		\cdot
		log
		\left[
		\mu_{3}
		\right]
		-
		log
		\left[
		A_3
		\right]
		+
		log
		\left[
		n_{b}
		\right]
		-
		log
		\left[
		n_{vol}	
	\right]
		\label{logf}
\end{multline}

\noindent Expanding $g(n_a)$ and $g(n_a +1)$.

\begin{multline}
	log
	\left[
	f(n_a,n_b)
	\right]
	=
	log
		\left[
		A_2
		\right]
		+
		log\left[
            \gOFm{n_a+1}{n_{surf}}
        \right]\\
        -
        log\left[
            \gOFm{n_a}{n_{surf}}
        \right]
		+
		log
		\left[
		n_{surf}
		\right]
		-
		log
		\left[
		n_a+1
		\right]
		-
		r
		\cdot
		log
		\left[
		\mu_{3}
		\right]\\
		-
		log
		\left[
		A_3
		\right]
		+
		log
		\left[
		n_{b}
		\right]
		-
		log
		\left[
		n_{vol}	
	\right]
		\label{logfexpnd1}
\end{multline}

\noindent Expanding the logarithms of $g(n_a)$ and $g(n_a +1)$.

\begin{multline}
	log
	\left[
	    f(n_a,n_b)
	\right]
	=
	log
	\left[
		A_2
	\right]\\
	+
	\logOFgOFm{(n_a+1)}\\
    -
    \logOFgOFm{n_a}\\
	+
	log
	\left[
		n_{surf}
	\right]
		-
		log
		\left[
		n_a+1
		\right]
		-
		r
		\cdot
		log
		\left[
		\mu_{3}
		\right]
		-
		log
		\left[
		A_3
		\right]
		+
		log
		\left[
		n_{b}
		\right]
		-
		log
		\left[
		n_{vol}	
	\right]
		\label{logfexpnd1}
\end{multline}


\noindent Using the stirling approximation on the logarithms of factorials.

\begin{multline}
	log
	\left[
	    f(n_a,n_b)
	\right]
	=
	log
	\left[
		A_2
	\right]\\
	+
	\StirlOFgOFm{(n_a+1)}\\
    -
    \StirlOFgOFm{n_a}\\
	+
	log
	\left[
		n_{surf}
	\right]
		-
		log
		\left[
		n_a+1
		\right]
		-
		r
		\cdot
		log
		\left[
		\mu_{3}
		\right]
		-
		log
		\left[
		A_3
		\right]
		+
		log
		\left[
		n_{b}
		\right]
		-
		log
		\left[
		n_{vol}	
	\right]
		\label{stirlOFexpnd1}
\end{multline}

\noindent The function from expression \ref{fnanb} is a method that compares two adjacent [there's a better way of saying this] polymer attachment scenarios. This tool enables to find where two attachment scenarios are equivalent in Q partition functions which is represented by $f(n_a,n_b)$ being equal to unity, and thus we have located a preferential scenario for looping. This process will be done through an iterative process described in the algorithm in the next section.

\section*{Algorithm}


%=======================================================================================
%%the figure has errors in the code so I am commenting it out until further notice
% \begin{figure}[h!]
% 	\centering
% 	\includegraphics[scale=0.85]{loopFigure_1.png}
% 	\caption{Multi-Chain Length Ratio Looping Ratio Comparison}
% 	\label{Multi}
% \end{figure}
%=======================================================================================

% \begin{figure}[h!]
% 	\centering
% 	\includegraphics[scale=0.85]{plotFigure_2.png}
% 	\caption{Long Chain Length Looping Ratio Plot}
% 	\label{Long}
% \end{figure}


% \begin{figure}[h!]
% 	\centering
% 	\includegraphics[scale=0.85]{plotFigure_3.png}
% 	\caption{Arbitrary Chain Length Looping Ratio Plot}
% 	\label{Arbitrary}
% \end{figure}



% \begin{figure}[h!]
% 	\centering
% 	\includegraphics[scale=0.85]{plotFigure_4.png}
% 	\caption{Short Chain Length Looping Ratio Plot}
% 	\label{Short}
% \end{figure}

\begin{algorithm}[H]
	\begin{algorithmic}
		\State $res \gets [~]$
		\State $reslog \gets [~]$
		\State $\mu_2 \gets 2.638$
		\Comment{constant $\mu_2$, provided in Madras et al table 1.1}
		\State $\mu_3 \gets 4.684$
		\Comment{constant $\mu_3$, provided in Madras et al table 1.1}
		\State $A_2 \gets 1.1771$
		\Comment{Amplitude constant, https://polymerdatabase.com/polymer\%20physics/SAW.html}
		\State $A_3 \gets 1.205$
		\Comment{Amplitude constant, https://polymerdatabase.com/polymer\%20physics/SAW.html}
		\State $n_{surf} \gets 1437$
		\Comment{number of 1mer sites on surface lattice (we assumed an aggregate surface area)} 			
		\State $r \gets 229$
		\Comment{capacity of surface}
		\State $n_0 \gets n_{surf}+220$
		\State $n_a \gets n_0$
		\State $n_{vol} \gets \frac{n_{surf}}{3}$
		\Comment{$n_{vol}$ arb selected size, say $n_surf$/3 or $n_surf$/10}
		\State $n_L \gets 3 \times n_a$
		\Comment{number chains in the system, assume $n_L >>a$ this is an arbitrary quantity}\\
		\Function{StirlingApprox}{$x$}\\
		\Return \stirl{x}
		\EndFunction\\
		\Function{$logf$ }{$n_a,n_b$}\\
		\Return $log
        	\left[
        		A_2
        	\right]
        	+
        	\StirlOFgOFm{(n_a+1)}$\\
            $~~~~~~~~~-
            \StirlOFgOFm{n_a}
        	+
        	log
        	\left[
        		n_{surf}
        	\right]
        		-
        		log
        		\left[
        		n_a+1
        		\right]$\\
        		$~~~~~~~~~-
        		r
        		\cdot
        		log
        		\left[
        		\mu_{3}
        		\right]
        		-
        		log
        		\left[
        		A_3
        		\right]
        		+
        		log
        		\left[
        		n_{b}
        		\right]
        		-
        		log
        		\left[
        		n_{vol}	
        	\right]$
		\EndFunction\\
		\For{$j \in [n_0,~n_0+22]$}\\
		$logf(j,n_b)$
		\EndFor\\
		\textbf{PRINT} Plot
	\end{algorithmic}
\end{algorithm}

\newpage
\section*{Maximal Chains On Surface: Stopping Criterion}

We also seek to find the maximal number of loops. This can be done by deciding what the minimal number of trains would look like. Then for that value of trains we solve for the number of loops, this value is also going to be the stopping criterion for our problem.



\section*{Convexity Hypothesis}
In the modelling a pertinent question is given the fixed loop length, what is te preference of the system when it comes to loop generation distribution on the lattice. In other words we want to check if the shrinkage of the chains on the surface is shared equally. It could either be the case of a preference to the extremes of looping in high densities or that overall, there's uniform generation of loops throughout the lattice (with a consideration of very few outliers). In order to find out the preference we must test for convexity.\\

\noindent Given a partition function if as we increase the distance of the looped elements from the main diagonal we notice a jump in the contribution of the partition we can safely say there is a preference for boundary behaviours, whereas if the converse is true than we have a uniform generation of loops and can proceed with a convex approach.\\\\

\noindent Let partition function be: $F(Lp_1,Lp_2, \cdots)$ with $Lp_1\geq Lp_2$ if\\

\noindent We have a scenario of convexity and thus uniform loop generation, if the below is true.

$$F(Lp_1,Lp_2, \cdots)\leq F(Lp_1-1,Lp_2+1, \cdots)$$

\noindent Otherwise, if we notice,
$$F(Lp_1,Lp_2, \cdots)\geq F(Lp_1-1,Lp_2+1, \cdots)$$ 

\noindent then we have the scenario of loops forming in clusters as opposed to uniformly throughout the lattice.



 






\newpage
\section*{Appendix A: Nomenclature of Model by Fleer et al.}
The approximation we shall use is the one provided by Fleer et al.\cite{fleer1993polymers} and the the parameters of model are the following.\\\\
%
\begin{tabular}{c|l}
\hline
\textbf{r:} & is number of segments per chain,\\
\textbf{s:} & is the number of segments \\ 
$\mathbf{s_{lp}(s):}$ &is the (fixed) length of loops on an adsorbed chain.\\
$\mathbf{s_{tr}(s):}$ &is the length of trains on an adsorbed chain.\\
$\mathbf{n_{tr}(s):}$ & is the number of trains of length \textbf{s}  on the adsorbed chain.\\
$\mathbf{n_{tl}(s):}$ &is the number of tails, of length \textbf{s}  on the adsorbed chain.\\
$\mathbf{n_{lp}(s):}$ &is the number of loops, of length \textbf{s}  on the adsorbed chain.\\
\textbf{l:}&bond length, lattice step length\\
\textbf{z:}&distance where walk terminates\\
$\mathbf{n_a:}$ &number of adsorbed chains\\
$\mathbf{n_b:}$&number of chains in solution\\
$\mathbf{q_{ch}}$&partition function of one adsorbed chain,\\
$\mathbf{A,A^{*}:}$& mixing of energetic param. of segmenet and solvent molecules\footnotemark \\
$\mathbf{\lambda_1:}$&probability of $\Delta z=-l$ or $l$\\
$\mathbf{\lambda_0:}$ &probability $\Delta z=0$\\
$\mathbf{\chi_{s}:}$ &Adsorption energy parameter\\
$\mathbf{q_{tr}(s)}$: & partition function of a train of segments, include energetic component $e^{\chi_s}$.\\
$\mathbf{\omega_{tl}(s)}$:&partition function of a tail of segments\\
$\mathbf{\omega_{lp}(s)}$:&partition function of a loop of segments\\
$\mathbf{\omega_0(z,s+1)}$:&approximation of $\omega_0(z,s)$ using CLT for $s>>>0$ \\
$\mathbf{\omega_{0}(z,s)}$:& $\frac{\Omega_0(z,s)}{\Omega_0(s)}$\\
$\mathbf{\omega_{0}(z,s,k)}$:& $\frac{\Omega_0(z,s,k)}{\Omega_0(s)}$\\
$\mathbf{\Omega_{0}(s)}$:& degeneracy of a free walk of s segments.\\
$\mathbf{\Omega_{0}(z,s)}$:&degeneracy of a free walk of s segments ending at z.\\
&(ie; How many possibilities $\Omega_{0}(z,s)$ exist for a walk that is terminated at z and has s-1 steps?)\\
$\mathbf{\Omega_{0}(z,s,k)}$: & degeneracy of a free walk of s segments ending at z, having k steps in the z direction.\\
$\mathbf{\Omega_{res}(s)}$:&degeneracy of a restricted walk of s segments.\\
$\mathbf{\Omega_{res}(z,s)}$:&degeneracy of a restricted walk of s segments ending at z.\\
$\mathbf{\Omega_{res}(z,s,k)}$:&degeneracy of a restricted walk of s segments ending at z, having k steps in the z direction.\\
\hline
\end{tabular} 
\footnotetext{We ignore the effects of mixing and interaction in our approximation}
		
		
		
		\begin{itemize}
			\item $\omega_0(z,s+1)=(4\pi\lambda_1s)^{-\frac{1}{2}} \cdot(e^{\frac{-z^2}{4\lambda_1 s l^2}})$,
			\item $\omega_{tl}(s)=\lambda_1 \cdot(\omega_0(0,s)+\omega_0(l,s))$,
			\item $\omega_{tl}(s+1)=\frac{\lambda_1}{\pi s}$,  (Approximation by CLT, for $s>>0$) 
			\item $\omega_{lp}(s)=\frac{\lambda_1}{s}\omega_0(l,s+1)$,  
			\item $\omega_{lp}(s)=\left(\frac{\lambda_1}{4\pi}\right)^{\frac{1}{2}}s^{-\frac{3}{2}}$, (Approximation by CLT, for $s>>0$) 
			\item $q_{tr}(s)={\lambda_0}^{s-1}\cdot e^{s\chi_s}$
			\item$\displaystyle q_{ch}=\sum \left[n_{tr}!\prod_{s}\frac{\left(q_{tr}(s)\right)^{n_{tr}(s)}}{n_{tr}(s)!}\right]\cdot\left[n_{lp}!\prod_{s}\frac{\left(\omega_{lp}(s)\right)^{n_{lp}(s)}}{n_{lp}(s)!}\right]\cdot\left[\prod_{s}\left(\omega_{tl}(s)\right)^{n_{tl}(s)}\right]$~~~~~~\footnote{We ignore the affect of tails so we remove that from the factors $q_{ch}$.}\\
			 $\displaystyle\text{Subject to:  } s\cdot \sum_{s} n_{tr}(s)+s\cdot \sum_{s} n_{lp}(s)+s \cdot \sum_{s} n_{tl}(s)=r$\\
			 $n_{tr}=n_{lp}+1$\\
			 $n_{tl}=2$
			\item $\displaystyle Q=n!\sum_{n_a,n_b}\left(q_{ch}^{n_{a}}\frac{V_{m}^{n_{a}}}{n_a!}\frac{V^{n_{b}}}{n_b!}\right)\cdot \left(e^{^{\frac{A-A^{*}}{kT}}}\right)$
		\end{itemize}



 
% \subsection*{Assumptions and Model Parameters}
% \textbf{}\\
% \begin{center}
% \begin{tabular}{r|c|l}
% 	\textbf{Topic} & \textbf{Acronyms} & \textbf{Assumptions \& Comments} \\ 
% 	&\textbf{\& Figures}&\\
% 	\hline
% 	&&\\
% 	Coverage&  &Assuming full coverage scenario for n-mer chains being attached to\\ &&the spherical surface. \\ &&(Feb11-upd) It is actually not considered full coverage as we remove mers\\ &&to create loops. It is a temporary capping process of salt molecules\\
% 	&&\\
% 	\hline
% 	&&\\ 	
% 	Lattice Geometry& Figure 1 & Original spherical lattice surface shall be approximated by a\\ &&rectangular surface lattice\\
% 	&&\\
% 	\hline
% 	&&\\ 
% 	Lattice Site Distibution& Figure 2 & Initial distribution of sites that will be a uniform mesh of rectangles with\\ &&area 1 Mer. We can assume that the attachment sites on the surface will\\ &&in every scenario be uniformly spaced due to repulsion effects \\
% 	&&\\
% 	\hline
% 	&&\\ 
% 	Tails& $n_{tl}(s)~,$&We also will only focus on loops and for the time and ignore the effect of\\ &Figure 3&tails as they may complicate our first order approximation greatly.\\
% 	&&\\
% 	\hline
% 	&&\\ 
% 	%good template of max length
% 	Energetic Factor (Stickyness)& $e^{X_{S}}$&  Initially, shall ignore the compounding factor $e^{x_S}$ in the \\ &&modelling, but later attempt to have it incorporated.We are hoping that in\\ &&every case but the partial scenarios, it will drop,\\
% 	&&\\
% 	\hline
% 	&&\\ 
% 	Partial Adsorbtion& $\vdots$& We also would like to consider scenarios of partial adsorbtion,\\&&in further iterations\\
% 	&&\\
% 	\hline
% 	&&\\ 
% 	Stiffness/Flexibility& $\vdots$& A recommendation for further extensions\\
% 	&&\\ 
% 	\hline 
% \end{tabular}
% \end{center}



%\begin{figure}[h!]
%	\includegraphics[scale=0.1]{lattice.pdf}
%\end{figure}
\newpage
% \begin{figure}[h!]%makes it stay in the section
% 	\centering
% 	\begin{subfigure}[b]{0.45\textwidth}
% 		\centering
% 		\includegraphics[scale=0.1]{latticeDense.pdf}
% 		\caption{Highest Charge \\Density}
% 		\label{fig:gull}
% 	\end{subfigure}
% 	\begin{subfigure}[b]{0.45\textwidth}
% 		\centering
% 		\includegraphics[scale=0.1]{latticeMid.pdf}
% 		\caption{Lower Charge \\Density}
% 		\label{fig:gull}	
% 	\end{subfigure}
% 	\begin{subfigure}[b]{0.45\textwidth}
% 		\centering
% 		\includegraphics[scale=0.1]{latticeSparse.pdf}
% 		\caption{Lowest Charge \\Density}
% 		\label{fig:gull}
% 	\end{subfigure}
% 	\caption{Initial Spherical Lattices}
% \end{figure}


% \begin{figure}[h!]%makes it stay in the section
% 	\centering
% 	\begin{subfigure}[b]{0.3\textwidth}
% 		\centering
% 		\includegraphics[scale=0.35]{squarelatticeDense.pdf}
% 		\caption{Highest Charge \\Density}
% 		\label{fig:gull}
% 	\end{subfigure}~~~~~~~~~~~
% 	\begin{subfigure}[b]{0.3\textwidth}
% 		\centering
% 		\includegraphics[scale=0.53]{squarelatticeMid.pdf}
% 		\caption{Lower Charge \\Density}
% 		\label{fig:gull}	
% 	\end{subfigure}~~~~~~~~~~~
% 	\begin{subfigure}[b]{0.3\textwidth}
% 		\centering
% 		\includegraphics[scale=0.98]{squarelatticeSparse.pdf}
% 		\caption{Lowest Charge \\Density}
% 		\label{fig:gull}
% 	\end{subfigure}
% 	\caption{Approximation to square lattice}
% \end{figure}

% \textbf{}\\
% \begin{figure}[h!]
% 	\centering
% 	\includegraphics[scale=0.5]{Clipboard.png}
% 	\caption{Illustration of trains,tails, loops\cite{fleer1993polymers}}
% 	\label{fig:gull}
% \end{figure}


\newpage
\section*{Appendix C: Parameter Calculation}

\begin{figure}[h!]%makes it stay in the section
    \centering
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[scale=0.5]{c-c.jpg}
        \caption{Single Mer}
        \label{fig:gull}
    \end{subfigure}
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[scale=0.25]{fig2.jpg}
        \caption{Sphere}
        \label{fig:mouse}
    \end{subfigure}
    \caption{}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[scale=0.4]{angles.jpeg}
\caption{Single Mer}
\end{figure}


\noindent \textbf{(1)}$\textbf{N}_{Short} \approx 27~Mers$\\
\textbf{(3)}$\textbf{N}_{Long} \approx 6200~Mers$\\
\textbf{(4)} $E[~2\cdot r_{sphere}~]\approx 85~nm$\\
\textbf{(5)} $\mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C-C}$}}=.154~nm$\\
\textbf{(6)} $\mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C=O}$}}=.745~nm$\\
\textbf{(7)} $\mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C-H}$}}=.109~nm$\\
\textbf{(8)} $\phi_{\scalebox{.7}{$\scriptscriptstyle \chemfig{C-O,C=O}$}}=\frac{2\pi}{3}\Rightarrow$Orth.Triangle has, $\theta=\frac{\pi}{3}$\\
\textbf{(9)} $\mathbb{L}_{\scriptscriptstyle Short}\approx8.3~nm$\\
\textbf{(10)} $\mathbb{L}_{\scriptscriptstyle Long}\approx 1910~nm$\\
\textbf{(11)} $\textbf{Area}_{\scriptscriptstyle Sphere} \approx 2300~nm^2$\\
\textbf{(12)} $\textbf{H}_{\scriptscriptstyle Figure2}=cos\theta \cdot (\mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C=O}$}})=cos(\frac{\pi}{3}) \cdot(.745)=.373~nm$\\
\textbf{(13)} $\textbf{TotalHeight}_{SingleMer}=H+\mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C-H}$}}=(.373)+(.109)=.482~nm$\\
\textbf{(14)} $\textbf{TotalLength}_{SingleMer} = 2 \cdot \mathbb{L}_{\scalebox{.82}{$\scriptscriptstyle \chemfig{C-C}$}} = .308~nm$\\
\textbf{(15)} $\textbf{Area}_{\scriptscriptstyle SingleMer} =(.482) \cdot(.308) =.148~nm^2$\\
\textbf{(16)} $\textbf{Area}_{\scriptscriptstyle ShortMer} =\textbf{Area}_{\scriptscriptstyle SingleMer}\cdot N_{Short}=(.148)\cdot 27\approx 3.99 ~nm^2$\\
\textbf{(17)} $\textbf{Area}_{\scriptscriptstyle LongMer} =\textbf{Area}_{\scriptscriptstyle SingleMer}\cdot N_{Long}=(.148)\cdot 6200 \approx 918~nm^2$



\newpage
\bibliographystyle{unsrt}
\bibliography{bibliography} % Use sample.bib as the bibliography file


\end{document}