\documentclass[12pt,letterpaper]{article}
\usepackage[scale=0.75]{geometry}
\usepackage[version=3]{mhchem} 
\usepackage[english]{babel}
\usepackage{chemfig}
\newcommand{\species}[1]{\textit{#1} sp.}
\usepackage{subcaption}
\newcommand{\leng}{\mathcal{L}}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{subcaption}
\usepackage{cancel}
% \usepackage[sort, numbers]{natbib}
% \usepackage[superscript]{cite}
\usepackage{float}%for [H]
\usepackage[font=small,labelfont=bf]{caption}
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

\usepackage{lipsum}
\usepackage{tcolorbox}
\usepackage{units}
\usepackage{mathrsfs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   a header of sorts..                           %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\lr}[1]{\left( #1 \right)}
\newcommand{\lrb}[1]{\left[ #1 \right]}
\newcommand{\lrcb}[1]{\left\{ #1 \right\}}
\newcommand{\ab}[1]{\ensuremath{\left| #1 \right|}}
\newcommand{\norm}[1]{\ensuremath{\left|\left| #1 \right|\right|}}
\newcommand{\norms}[2]{\ensuremath{\norm{#1}_{#2}}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Cx}{\mathbb{C}}
\newcommand{\fop}{\ensuremath{\mathcal{F}}}
\newcommand{\schw}{\ensuremath{\mathscr{S}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %To remove auto indenting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newlength\tindent
\setlength{\tindent}{\parindent}
\setlength{\parindent}{0pt}
\renewcommand{\indent}{\hspace*{\tindent}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\nads}[1]{
    \ensuremath{
        \frac{
            n_{surf}
        }{
            #1
        }
    }
}
%
\newcommand{\nlp}[1]{
    \ensuremath{
        \frac{
            r
            -
            \nads{#1}
        }{
            s_{lp}
        }
    }
}
%
\newcommand{\stirl}[1]{
    \ensuremath{
        \left(
            #1
        \right)
        \cdotp 
        log
        \left[
            \left(
            #1
            \right)
        \right]
        -
        \left(
            #1
        \right)
    }
}
%
\newcommand{\stirlBraces}[1]{
    \ensuremath{
        \left\{
            \left(
                #1
            \right)
            \cdotp 
            log
            \left[
            \left(
                #1
            \right)
            \right]
            -
            \left(
                #1
            \right)
        \right\}
    }
}
%
\newcommand{\facto}[2]{
    \ensuremath{
        \frac{
        #1!
        }{
        \lr{
        #2
        }!
        \lr{
        #1
        -
        #2
        }!
        }
    }
}

\newcommand{\logOFgOFm}[1]{
	\ensuremath{
	#1
	\cdot
	\left\{
    	log
    	\left[
    	    \left(
    	        \nads{#1}
    	    \right)!
    	\right]
    	-
    	log
    	\left[
        	\left(
        	    \nlp{#1}
        	\right)!
    	\right]
    	-
    	log
    	\left[
    	    \left(
        	    2
        	    \cdot
        	    \nads{#1}
        	    -
        	    r
            \right)!
    	\right]
	\right\}
	}
}
%\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000
%





\title{Adsorption of Polyelectrolytes to a Spherical Colloid Surface with Variable Loop Considerations}
\author{Spyros Koumarianos}
\date{\today}
%
\begin{document}


\maketitle
\begin{abstract}
\lipsum[1]
\end{abstract}
%
\tableofcontents
% \listoffigures
%\lstlistoflistings
%


\newpage

\section{Introduction}
%
\lipsum[15-18]
%
% \subsection{Literature Review}



% properties of layers of adsorbed polymers,\cite{fleer1993polymers,stuart1996adsorbed,yethiraj2002polymer,stuart1998macromolecular,o2004non}

% statistical models in using mean-field framework \cite{scheutjens1980statistical,de1981polymer} simulation methods \cite{kramarenko1996molecular,striolo2001adsorption,sintes2001adsorption,striolo2005adsorption}

% dynamics of polymer adsorption  using dynamic mean-field techniques\cite{hasegawa1997adsorption}

% Brownian motion \cite{kallrot2007dynamic, kallrot2009} 

% molecular dynamics\cite{smith2005polymer,harmandaris2005molecular,daoulas2005detailed,li2007dynamics,chremos2009adsorption}


% dynamic Monte Carlo Methods \cite{jia1996kinetics, zajac1996statics,takeuchi1999monte,ponomarev2000adsorption,klein2005diffusion,smith2006monte,descas2006irreversible}

% different degrees of freedom \cite{kramarenko1996molecular,boehm1980statistical,netz1999adsorption,netz2003neutral,skvortsov1976monte,tang2010revisiting,linse2010polymer,klushin2013adsorption,kuznetsov1997new,maggs1989unbinding,birshtein1979adsorption,semenov1996adsorption}, 

% loops, tails and trains \cite{semenov1996adsorption,van1996adsorption,hoeve1965adsorption,silberberg1962adsorption} 


\newpage
\section{Modelling Setup and Approach}

\subsection{Preamble}

For the reader not fortunate enough to have been previously exposed to the wonderful world of random walks on a lattice, we proceed to clarify that the correspondence of polymer modelling with that of walks on a lattice. For example, the term polymer is instead referred to as a chain. Subsequently, the mers of a polymer correspond to that of sites on a chain. Important to clarify is that both the polymer and the surface of adsorption have sites, and from the perspective of the polymer this is the point on the polymer that will be in contact with the corresponding point on the lattice.
\textcolor{red}{(This may need some additional pruning, but for now is here as a remark.)} 
Similarly we have that steps are the modeller's way to refer to the bonds between a pair of mers on  a polymer. Henceforth, given that this approach will be entertained from the modelling perspective we will be consistent to the use of the newly introduced terminology from the discipline of random walks.\\

% \textcolor{red}{Concept of a walk (SAW)?, Concept of polygons (SAP)?, Self Avoiding?, Non reversing?,anything I missed?}



The type of walk focused on in this work, is that of a self avoiding walk on a lattice. This is a random path which "avoids" sites that it has already occupied. A self avoiding polygon is a subclass of self avoiding walks, with end-point vertex being adjacent to the origin of the walk \cite{guttmann1988self}.\\

\subsection{Parameters, Definitions}
\textbf{Sites:} The nodes on figure \ref{fig:loopSchem}\\

\textbf{Steps:} The edges between the nodes on figure 
\ref{fig:loopSchem}.\\

$
\boldsymbol{
    r
}
$: 
Number of sites in one chain.\\

$
\boldsymbol{
    r
    -
    1
}
$: 
Number of steps in one chain\\

$
\boldsymbol{
    n_{a}
}
$: 
Number of chains on the colloid surface.\\

$
\boldsymbol{
    n_{a,0}
}
$: 
initial value, of chains that can fit on the colloid surface (pancaked i.e.; no loops) this is also can be considered a minimum amount of chains for the surface.\\

$
\boldsymbol{
    n_{b}
}
$: 
Number of chains in the solution, based on a heuristic used in \cite{koumarianos2021theory}\\

$
\boldsymbol{
    n_{b,0}
}
$: 
initial value, of chains that can freefloat in solution. This is based on a model assumption of the distribution and quantity of chains in a specific volume of solution in \cite{koumarianos2021theory}. This is also can be considered a minimum amount of chains for the solution, as they progressively transition to being adsorbed to the colloid.\\


$
\boldsymbol{
    n
}
$: 
Total number of chains in the whole system.
\begin{equation}
n=n_a+n_b,
	\label{eq. n}
\end{equation}

$
\boldsymbol{
    s_{lp}
}
$: 
Number of steps in a single loop (on the simple cubic lattice, this is an even number, that is greater than or equal to 3).\\

$
\boldsymbol{
    s_{lp}
    +
    1
}
$:  
Number of sites in a single loop including the two endpoint sites that are in the surface.\\

$
\boldsymbol{
    s_{lp}
    -
    1
}
$: 
Number of sites in a single loop that do not lie in the surface.\\

% We have L to define this maybe uncomment in future we shall see...
% $
% \boldsymbol{
%     n_{ads}
% }
% $: 
% number of adsorbed sites, in mers per, chain (on average) as,

% \begin{equation}
% 	n_{ads}:= \frac{n_{surf}}{n_a}
% 	\label{nads}
% \end{equation}



$
\boldsymbol{
    n_{surf}
}
$: 
The total available sites on the surface of the colloid.\\

$
\boldsymbol{
n_{lp}
}
$: 
Number of loops in one chain.\\

$
\boldsymbol{
    N_{lp}
}
$: 
number of \underline{sites} in a chain, that reside in loops.\\

$\leng$: number of sites of a chain that are on the surface.\\

$\leng-1$: number of steps of a chain that are on the surface, including the "phantom steps" at the base of each loop.\footnote{Important to note here, is that our previous paper, used $\leng_{[ChainType]}$ for the number of sites in a chain (not the number of steps).  In Equation \ref{wk2supp} we want the number of steps, but in Equation \ref{Gofna} we want the number of sites. To be consistent with the other paper, we have opted to use $\leng$ for the number of sites.}\\

%%Keeping this bcz something about the explanation could come to use later
% L is a kind of remainder of mers on surface, and the $+n_{lp}$ is a "phantom" step

\paragraph{Intuition of the Above Quantities Using a Concrete Example} The explanation will be based on a concrete example of a single chain with one loop, this example is illustrated in Figure \ref{fig:loopSchem}.\\

An example of 
$
\boldsymbol{
\leng-1
}
$ 
would be steps, the the red steps of 
$
\boldsymbol{
step_{(1)}
}
$ 
to 
$
\boldsymbol{
step_{(17)}
}
$ 
including the green segment.\\

An illustration of $\boldsymbol{\leng}$ would be steps, the red steps ie; 
$
\boldsymbol{
step_{(1)}
}
$ 
to 
$
\boldsymbol{
step_{(17)}
}
$ 
excluding the green "phantom" step.\\

Now, in the case of enumerating \underline{sites} of a specific loop, we have that
$
\boldsymbol{
    s_{lp}
    +
    1
}
$
would be the blue steps of 
$
\boldsymbol{
step_{(4)}
}
$ 
to 
$
\boldsymbol{
step_{(14)}
}
$ 
including the sites linking the red segment to the blue segments which are labelled as that of: 
$
\boldsymbol{
site_{(3,4)}
}
$ 
and 
$
\boldsymbol{
site_{(14,15)}
}
$.\\

For the case of
$
\boldsymbol{
    s_{lp}
    -
    1
}
$
we are enumerating \underline{sites} of a specific loop that \underline{do not lie in the surface} (ie; exclusively reside in the 3D lattice) it would be the blue steps ie; 
$
\boldsymbol{
step_{(4)}
}
$ 
to 
$
\boldsymbol{
    step_{(14)}
}
$ excluding the sites between that link the red chain to the blue chain, namely that of: 
$
\boldsymbol{
site_{(3,4)}
}
$ 
and 
$
\boldsymbol{
site_{(14,15)}
}
$.\\

Now in the case of $
\boldsymbol{
    s_{lp}
    -
    1
}
$
we are enumerating \underline{steps} of a specific loop, namely the blue steps between and including that of: 
$
\boldsymbol{
    step_{(4)}
}
$ 
and 
$
\boldsymbol{
    step_{(14)}
}
$ 
and excluding the green segment, being the phantom step between 
$
\boldsymbol{
site_{(3,4)}
}
$ 
and 
$
\boldsymbol{
site_{(14,15)}
}
$.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.50]{stickball1.pdf}
    \caption{Caption}
    \label{fig:loopSchem}
\end{figure}


\paragraph{Initial Relationships of the Model} Using the above defined variables and functions we have the following preliminary relationships.

\begin{equation}
	    n_{surf}= \leng\;n_a
	    \label{eq.nsurf}
\end{equation}

\begin{equation}
	n_{lp}:= \frac{r-\frac{n_{surf}}{n_a}}{s_{lp}-1}
	\label{eq.nlp}
\end{equation}



\begin{equation}
    N_{lp}:=r-\leng=r-\frac{n_{surf}}{n_a}
	\label{eq.mean_nlp}
\end{equation}



%
\begin{equation}
\leng
=
r 
- 
n_{lp}
(s_{lp}-1)
\label{eq.lengminus}
\end{equation}


%
\begin{equation}
\leng
-
1
=
(r-1) 
- 
n_{lp}
s_{lp}
+ 
n_{lp}
\label{Eq: leng}
\end{equation}


% (Note the two different ways of counting L and L-1 as described by the above bracketing, which are consistent)\\



% (needs asymptotic approximation as well so it can gain context for the reader, simple cubic lattice $Z^3$)
% \\


\begin{tcolorbox}[sharp corners, colback=green!30, colframe=green!80!blue, title=Brief Review of Self Avoiding Walks]
% \paragraph{Review of Self Avoiding Walks} 
The configuration  of a single  polymer in a dilute solution is often modeled by
a self-avoiding walk (SAW) in a lattice \cite{MadrasNotes2019}, i.e.\  a path in the lattice that does not visit any site more than once.
A fundamental property of SAWs is the following.  
Let $c_{\ell}$ be
the number of SAWs that start from a specified lattice site (``the origin'') and visit a total of $\ell$ sites
(including the starting site).   Then the 
asymptotic behaviour of $c_{\ell}$ on the three-dimensional cubic lattice is \cite{MadrasNotes2019}
\begin{equation}
    \label{eq.sawscale}
       c_{\ell}  \;\sim  \;  A_3 \, {\ell}^{\gamma_3-1}  \mu_3^{\ell}    \hspace{5mm}\hbox{as $\ell\rightarrow\infty$}.
\end{equation}
% (This has not been proven rigorously, but even mathematicians do not doubt its truth.) 
Here $\mu_3$ and $A_3$ depend on the choice of lattice, but $\gamma_3$ is a universal critical exponent
that is the same for all three-dimensional lattices.  
Their values are known to be approximately \cite{chen2002universal, madras2013self}
\begin{equation}
   \label{eq.gammas}   \mu_3 \;=\;  4.684, \hspace{5mm}
        \gamma_3 \;=\;  1.162,    \hspace{5mm}\hbox{and}\hspace{5mm}
    A_3  \;=\;    0.2573  \,.  %1.205/4.683 \;=\;  \,.
\end{equation}
(Estimation in \cite{chen2002universal} is for the 
number of SAWs with $\ell$ \textit{steps} (i.e.\ $\ell+1$ \textit{sites}), which we write  $c_{\ell+1}=(A_3\mu_3)\ell^{\gamma_3-1}\mu_3^{\ell}$; reference \cite{chen2002universal} obtains $A_3\mu_3=1.205$.)
\end{tcolorbox}
\text{}\\

$\boldsymbol{A_3}$: amplitude for computing the number of self avoiding walk in a three dimensional cubic lattice.\\

$\boldsymbol{\mu_3}$: connective constant for the computing the number of self avoiding walk in three dimensional cubic lattice.\\

\begin{tcolorbox}
A similar approach \cite{guttmann2009polygons} is followed for the enumeration of Self Avoiding Polygons (SAP). In the literature \cite{guttmann2009polygons}, the most commonly used notation for the amplitude of (SAP) in a simple cubic lattice ($Z^3$),is that of $B_3$.
\end{tcolorbox}

$\boldsymbol{B_3}$: amplitude for computing the self avoiding polygon, in a three dimensional cubic lattice.

\subsection{Development of a Mean Field approach with Loop Considerations}

Based on the derivations in the supplement of  \cite{koumarianos2021theory}, we have that $\tilde{w}_k$ is the number of ways to place the $k^{th}$ chain of adjusted size $\leng$, given the prior information of having already placed
%
$$
(k-1)\leng
$$
%
mers on the two dimensional lattice. We let $q$ be the number of nearest neighbours of each site on the surface. 
%
% In the previous work\cite{koumarianos2021theory}, using a Flory-Huggins approach, $\tilde{w}_k$ was derived to be that of Equation \ref{wk2supp}.
% The reasoning of the approach is the following.\\
%
%
Given an arbitrary value $j$, we want to calculate the amount of ways that $j$ $\leng$-mers could be placed on the surface, without overlapping.
%
We place one polymer at a time, starting with the long ones.
%
% Let $\tilde{w}_k$ be the number of ways to place the $k^{th}$ $\leng_L$-mer on the surface, given that
% $(k-1)$ $\leng_L$-mers have already been placed.  
%
To begin with, there are
$$
n_a\leng-(k-1)\leng
$$
available sites for the first monomer. 
%
Recall that  $q$ is the number of neighbors of each site in the surface lattice.
%
When considering the adsorption of the first chain without any other chains on the surface, there would be $\lambda$ choices for the second monomer in the chain,
and $\lambda-1$ choices for each monomer after that 
%
%(here we are using the non-reversed walk model of a polymer instead of the fully self-avoiding model).  
%
More generally, the above value of choices, should on average be reduced by the fraction of the surface that has already been covered.
%
When considering the placement of the second monomer of the chain, there would be
$$
n_a\leng-(k-1)\leng-1
$$
unoccupied sites, which means that each site has probability 
$$
\frac{n_a\leng-(k-1)\leng-1}{n_a\leng}
$$
of being available.  
This results in
$$
\lambda
\frac{
    n_a
    \leng
    -
    (k-1)
    \leng
    -
    1
}{
    n_a
    \leng
}
$$
choices for the second monomer. Similarly, after $i$ monomers of the current chain have been placed ($i\geq 2$), the fraction of the surface that has not been covered is
$$
\frac{n_a\leng-(k-1)\leng-i}{n_a\leng},
$$
so there are
$$
(
\lambda
-1
)
\frac{
n_a
\leng
-
(k-1)
\leng
-
i
}{
a\leng
}
$$
choices for the $(i+1)^{th}$ monomer in this chain. We conclude that 
\begin{eqnarray}
   \tilde{w}_k  & = &   [a\leng-(k-1)\leng]\,\times \,\lambda\left(\frac{ a\leng-(k-1)\leng-1}{a\leng}\right)    \,\times
   \nonumber    \\
   & &    \hspace{22mm}
     \prod_{i=2}^{\leng-1}(\lambda-1)\left(\frac{ a\leng-(k-1)\leng-i}{a\leng}\right)  
      \nonumber \\
 & = &    \frac{[a\leng-(k-1)\leng]!}{[a\leng-k\leng]!} \,\lambda\,  \frac{(\lambda-1)^{\leng-2}}{(a\leng)^{\leng-1}}  
     \nonumber    \\
     & = &    \frac{[a\leng-(k-1)\leng]!}{[a\leng-k\leng]!}   a\leng \frac{\lambda}{(\lambda-1)^2}\left(  \frac{\lambda-1}{a\leng}\right)^{\leng}.
     \label{eq.wk2supp}
\end{eqnarray}

We then take into account Equation \ref{eq.nsurf} which leads to the following simplification,

\begin{equation}
   \tilde{w}_k 
   =
   \frac{
        [
            n_{surf}
            -
            (
                    k
                -
                1
            )
                \leng
        ]
        !
   }{
        [
            n_{surf}
            -
        k
        \leng
        ]
        !
   }   
    n_{surf}
   \frac{
        \lambda
   }{
        (\lambda-1)^2
   }
   \left(
        \frac{
            \lambda
            -
            1
        }{
            n_{surf}
        }
    \right)
    ^{
            \leng
    }.
    \label{wk2supp}
\end{equation}

For the set corresponding to all iterations for up to and including the full coverage scenario we then have, 


\begin{equation}
    \fop(n_a) 
    :=      
    \frac{
        \tilde{w}_1
        \tilde{w}_2
        \cdots 
        \tilde{w}_{n_a}
    }{
        n_a!
    }
    \label{Gofna}
\end{equation}




So for one chain we want to see where the looping will take place. We have devised a treatment such that the loops will always be atop two adsorbed mers. The following factors are used to calculate how these loops will be placed and how the cardinalities of the combinations are computed.\\


% \textcolor{red}{(Missing: Explaining/illustrating the concept of concatenating the two surface segments into one contiguous train, *version 1 of my note from meeting)}\\

We have that the choice of sites of loops on chain is represented by the below binomial coefficient notation,

\begin{equation}
\lr{
\begin{array}{c}
     \leng\\
     n_{lp} 
\end{array}
}
\label{eq.looploc}
\end{equation}

%%SK: Explain what exactly this is and how it came to be
as well as the Fleer Factor, this is the number of possible loops over a phantom bond.
\begin{equation}
    \lr{
        \frac{
            \mu_3^{
                s_{lp}
            }
        }{
            s_{lp}^{3.7}
        }
        B_3
    }
\label{FleerFactor}
\end{equation}

and this is the number of possible loops for all phantom bonds of the surface,

\begin{equation}
    \lr{
        \frac{
            \mu_3^{
                s_{lp}
            }
        }{
            s_{lp}^{3.7}
        }
        B_3
    }
    ^{
        n_{lp}            
    }
\label{FleerFactor}
\end{equation}

Putting the above factors together
% \textcolor{red}{(Missing: the concept of linkage at the point of the "shadow" chain *version 2 of note from meeting)}
into an expression for the loops, we have $q_{lp}$ which is, the number of ways to configure a loop of that size in a three dimensional cubic lattice.


\begin{equation}
    q_{lp}
    := 
    %
    \lr{
    \begin{array}{c}
         \leng\\
         n_{lp} 
    \end{array}
    }   
    %
    ~
    %
    \lr{
                \frac{
                    \mu_3^{
                        s_{lp}
                    }
                }{
                    s_{lp}^{3.7}
                }
                B_3
            }
            ^{
                n_{lp}            
    }
\label{refEnum}
\end{equation}

Using the relationship from Equation \ref{eq.sawscale}, we have that the number of self avoiding walks from a specific starting point is approximately 

\begin{equation}
	    \left(A_3\cdot (\mu_{3})^{r}\right).
	\label{eq. SAW}
\end{equation}

In terms of notational book-keeping, we assume this to be approximately the value of the partition function for the solution, $q_{vol}$.

\begin{equation}
	    q_{vol}\approx \left(A_3\cdot (\mu_{3})^{r}\right).
	\label{eq. q3}
\end{equation}


\paragraph{Fleer Approximation} Presented below is the formulation by Fleer \cite{fleer1993polymers} on the analysis of partition functions with the consideration of looping. This will serve as the scaffolding on which we will build up our own model. The original consideration of tails, energetic factors as well as the interactions, will be ignored in this model.\\

We get the following generalized partition function for the whole system based on the expressions from Fleer\cite{fleer1993polymers}.

\begin{equation}
	Q(n_a)
	=
	n!
	\left(
	    \fop(n_a)
	    ~
	    q_{lp}^{n_a}
	    ~
		q_{vol}^{n_{b}}
		~
		\frac{
			n_{vol}^{n_{b}}
		}{
			n_b!
		}
	\right)
	\label{Qfleer1}
\end{equation}


You will notice that notationally, anything that is dependant on $n_a$ we shall increment by one 
% \textcolor{red}{(one what?)}. 
For the convenience of the reader, we use the below notation.

\begin{table}[H]
\begin{center}
\begin{tabular}{|c|c|c|}
    \hline
    Function  & Representation & Representation\\ $f(x)$ & of $f(n_a)$ & of $f(n_a+1)$  \\
    \hline\hline
    $\fop(n_a)$ & $\fop$  &  $\fop^{*}$\\  
    \hline
    $q_{lp}(n_a)$ & $q_{lp}$  & $q_{lp}^{*}$\\
    \hline    
    $n_b(n_a)$ & $n_b$ & $n_b^{*}$\\
    \hline
    $\leng(n_a)$ & $\leng$ & $\leng^{*}$\\
    \hline
\end{tabular}
\end{center}
\caption*{\textbf{Table 1: Functional Representations}}
\end{table}


This gives us the following expression for     

\begin{equation}
\frac{
        Q^{*}
}{
	    Q
}
=
    \cancel{
    	\frac{
    	    n!
    	}{
    	    n!
    	}
    }
	\left(
	    \frac{
	        \fop^{*}
	    }{
	        \fop
	    }
	    ~
	    \frac{
	        \lr{
	            q_{lp}^{*}
	        }
	        ^{
    	        n_{lp}^{*}
    	    }
	    }{
	        \lr{
	            q_{lp}	        
    	    }
    	    ^{
    	        n_{lp}
    	    }
	    }
	    ~
	    \frac{
    	    q_{vol}^{n_{b}^{*}}
    	}{
    	    q_{vol}^{n_{b}}
    	}
    	~
    	\frac{
    		\frac{
    			n_{vol}^{n_{b}^{*}}
    		}{
    			n_b^{*}!
    		}
		}{	
    		\frac{
    			n_{vol}^{n_{b}}
    		}{
    			n_b!
    		}
		}
	\right)
	\label{Eq: RatQ}
\end{equation}


Looking at these ratio factors one by one, starting with


\begin{align}
\label{nbnvol}
    \frac{
        \lr{\displaystyle
        		\frac{
        			n_{vol}^{n_{b}^{*}}
        		}{
        			n_b^{*}!
        		}
        }
    }{
        \lr{\displaystyle
        		\frac{
        			n_{vol}^{n_{b}}
        		}{
        		    \lr{
        			    n_b
        		    }!
        		}
        	}
    }\nonumber
    &=
	\frac{
	    \lr{
	        \displaystyle
    		\frac{
    			n_{vol}^{n_{b}-1}
    		}{
    			(n_b-1)!
    		}
		}
	}{
		\lr{
		    \displaystyle	
    		\frac{
    			n_{vol}^{n_{b}}
    		}{
    			n_b!
    		}
    	}	
	}\\
	&=
	\frac{
        n_{vol}^{n_{b}-1} 
    	\times
    	n_b!
    }{
	    n_{vol}^{n_{b}}
		\times
		(n_b-1)!
	}\\
	&=
	n_{vol}^{\cancel{n_{b}}-1-\cancel{n_{b}}} 
	n_b\nonumber\\
	&=
	\frac{
	    n_b
	}{
	    n_{vol} 
	}\nonumber
\end{align}

Using a similar manipulation of exponents as that of $n_{vol}$ we get the following,

\begin{equation}
\frac{
    	    q_{vol}^{n_{b}^{*}}
    	}{
    	    q_{vol}^{n_{b}}
}
=
\frac{
    1
}{
    q_{vol}
}
\label{qvoloverqvol}
\end{equation}

Combining the calculations from Equations \ref{nbnvol} and \ref{qvoloverqvol}

\begin{equation}
    R_{vol}:=
    		\frac{
		    n_b
		}{
		    n_{vol} 
		}
		~
    \frac{
    1
}{
    q_{vol}
}
   \label{Rvol}
\end{equation}

We then have,

\begin{align}
\label{eq. goverg}
\frac{
    \fop^{*}
}{
    \fop
}
&=
\frac{
    \frac{
        \tilde{w}_1
        \tilde{w}_2
        \cdots 
        \tilde{w}_{n_a+1}
    }{
        (n_a+1)!
    }   
}{   
    \frac{
        \tilde{w}_1
        \tilde{w}_2
        \cdots 
        \tilde{w}_{n_a}
    }{
        n_a!
    }   
}\nonumber\\
&=
\frac{
        n_a!
        \lr{
            \tilde{w}_1
            \tilde{w}_2
            \cdots 
            \tilde{w}_{n_a+1}
        }       
}{ 
        (n_a+1)!
        \lr{
            \tilde{w}_1
            \tilde{w}_2
            \cdots 
            \tilde{w}_{n_a}
            }
}\\
&=
\frac{
        \lr{
            \cancel{
                \tilde{w}_1
                \tilde{w}_2
                \cdots 
                \tilde{w}_{n_a}
            }
            \tilde{w}_{n_a+1}
        }       
}{ 
        (n_a+1)
        \cancel{
            \lr{
                \tilde{w}_1
                \tilde{w}_2
                \cdots 
                \tilde{w}_{n_a}
                }
        }
}\nonumber\\
&=
\frac{
            \tilde{w}_{n_a+1}       
}{ 
        (n_a+1)
}\nonumber
\end{align}

Where we assign the resulting expression from \ref{eq. goverg} to,

\begin{equation}
    R_{\fop}:=
    \frac{
                \tilde{w}_{n_a+1}       
    }{ 
            (n_a+1)
    }~~~\textbf{.}
   \label{Eq: RG}
\end{equation}

Where,

\begin{equation}
   \tilde{w}_{n_a+1} 
   =
   \frac{
        [
            n_{surf}
            -
            n_a
            \leng
        ]
        !
   }{
        [
            n_{surf}
            -
        (n_a+1)
        \leng
        ]
        !
   }   
    n_{surf}
   \frac{
        \lambda
   }{
        (\lambda-1)^2
   }
   \left(
        \frac{
            \lambda
            -
            1
        }{
            n_{surf}
        }
    \right)
    ^{
            \leng
    }.
    \label{wk2supp}
\end{equation}

For the factor below we have, 
%my understanding here is we will leave the simplification to be done by the logarithm. Except if the $n_{lp}\cdot n_a$, reduces to something nicer.
%we will leave this expression as is given it's complexity, and have it simplified when we take the logarithmic and stirling approximations for the factorials.

\begin{equation}
\frac{
    \lr{
        q_{lp}^{*}
    }
}{
    \lr{
        q_{lp}
    }
}
=
\frac{
        \lr{
        \begin{array}{c}
             \leng^{*}\\
             n_{lp}^{*}
        \end{array}
        }^{n_a+1}   
        ~
        \lr{
                    \frac{
                        \mu_3^{
                            s_{lp}
                        }
                    }{
                        s_{lp}^{2.8}
                    }
                    B_3
                }
                ^{
                    n_{lp}^{*}\cdot (n_a+1)
                }
}{
        \lr{
        \begin{array}{c}
             \leng\\
             n_{lp} 
        \end{array}
        }^{n_a}   
        ~
        \lr{
                    \frac{
                        \mu_3^{
                            s_{lp}
                        }
                    }{
                        s_{lp}^{2.8}
                    }
                    B_3
                }
                ^{
                    n_{lp}\cdot n_a            
        }
}
\label{Eq: qlpoverqlp}
\end{equation}

We further simplify the below expression,

% \textcolor{red}{(purposely didn't use $r-\leng$ here. Also could have just left in terms of $n_{lp}$ and $n_a$ and just simplified...)} 

\begin{align}
n_{lp}(n_a+1)
\cdot
(n_a+1)
-
n_{lp}(n_a)
\cdot
(n_a)
&=
\frac{
    r
    -
    \frac{
            n_{surf}
        }{
            n_a+1
    }
}{
    (s_{lp}-1)
}
-
\frac{
    r
    -
    \frac{
        n_{surf}
    }{
        n_a
    }
}{
    (s_{lp}-1)
}\nonumber\\
&=
\frac{
    r\cdot (n_a+1)
    -
    \cancel{
        n_{surf}
    }
    -
    r\cdot (n_a)
    +
    \cancel{
        n_{surf}
    }
}{
    (s_{lp}-1)
} \\
&=
\frac{
    r
}{
    (s_{lp}-1)
}
\lr{
    \cancel{
        n_a
    }
    +
    1
    -
    \cancel{
        n_a
    }
}
=
\frac{
    r
}{
    (s_{lp}-1)
},\nonumber
\end{align}



and as such we have Equation \ref{Eq: qlpoverqlp} becomes,

\begin{equation}
    R_{lp}:=
    \frac{
        \lr{
        \begin{array}{c}
             \leng^{*}\\
             n_{lp}^{*} 
        \end{array}
        }^{n_a+1}   
}{
        \lr{
        \begin{array}{c}
             \leng\\
             n_{lp}
        \end{array}
        }^{n_a}
}
~
\lr{
    \frac{
        \mu_3^{
            s_{lp}
        }
    }{
        s_{lp}^{2.8}
    }
    B_3
}
^{
    \frac{
        r
    }{
        s_{lp}-1
    }
}
\end{equation}


Combining the above results back into Equation \ref{Eq: RatQ}


\begin{equation}
    \frac{
        Q^{*}
    }{
        Q
    }
    =
    R_{\fop}
    \times
    R_{lp}
    \times
    R_{vol}
\label{finalflee}
\end{equation}

We now proceed to the following property of logarithms, 

\begin{equation}
    log
    \lr{
    \frac{
            Q^{*}
        }{
            Q
        }
    }
    =
    log(Q^{*})-log(Q),
\end{equation}

this leads us to the following simplification for our algorithmic approach, we substitute $log\lrb{Q(n_a)}$ with $Q_{log}$, and let,

\begin{equation}
log(Q^{*})
-
log(Q)
=
\Delta Q_{log}.
\label{eq.letdeltaq}
\end{equation}

This means that,

\begin{equation}
    \Delta Q_{log}    
    =
    log\lr{
        R_{\fop}
    }
    +
    log\lr{
        R_{lp}
    }
    +
    log\lr{
        R_{vol}
    }
\end{equation}

where,

\begin{align}
    log
    \lr{
    R_{\fop}
    }
    &=
    log
    \lr{
    \frac{
                \tilde{w}_{n_a+1}       
    }{ 
            (n_a+1)
    }
    }\\
    &=
    log
    \lr{
        \tilde{w}_{n_a+1} 
    }
    -
    log
    \lr{
        (n_a+1)
    }    
   \label{Eq: logRG}
\end{align}

Where we have that 
$
\log
\lrb{
   \tilde{w}_{n_a+1} 
}
$
is,

\begin{align}
   Stirl
   \lrb{
        n_{surf}
        -
        n_a
        \leng
    }
    -
    Stirl
    \lrb{
            n_{surf}
            -
        (n_a+1)
        \leng
   }
   &+
   \log
   \lrb{
    n_{surf}
    }
    +
    \log
   \lrb{
        \lambda
   }\nonumber\\
   &
   -
   2
   \log
   \lrb{
        (\lambda-1)
   }
   +
   \leng
   \left(
    \log
    \lrb{
            \lambda
            -
            1
    }
    -
    \log
    \lrb{
            n_{surf}
        }
    \right)
    .
    \label{wk2logsupp}
\end{align}

\begin{align}
     log
     \lr{
        R_{vol}
    }
    &=
    log
    \lr{
    	\frac{
		    n_b
		}{
		    n_{vol} q_{vol}
		}
    }\\
    &=
    log
    \lr{
        n_b
    }
    -
    log
    \lr{
        n_{vol}
    }
    -
    log
    \lr{
        q_{vol}
    }    
\end{align}

\begin{align}
\label{eq.LogRvol1}
log
\lr{
    R_{lp}
}
&=
\lr{n_a+1}   
log
\lr{
    \begin{array}{c}
    \leng^{*}\\
    n_{lp}^{*} 
    \end{array}
}
-
\lr{n_a}
log
\lr{
\begin{array}{c}
     \leng\\
     n_{lp}
\end{array}
}
+
\lr{
    \frac{
        r
    }{
        s_{lp}-1
    }
}
log
\lr{
    \frac{
        \mu_3^{
            s_{lp}
        }
    }{
        s_{lp}^{2.8}
    }
    B_3
}
\nonumber\\
&=
\lr{n_a+1}   
log
\lr{
    \facto{
        \leng^{*}
    }{
        n_{lp}^{*}
    }
}
-
\lr{n_a}
log
\lr{
    \facto{
        \leng
    }{
        n_{lp}
    }
}
\\
&\qquad\qquad\qquad
\qquad\qquad\qquad
\qquad\qquad\qquad
\qquad
+
\lr{
    \frac{
        r
    }{
        s_{lp}-1
    }
}
log
\lr{
    \frac{
        \mu_3^{
            s_{lp}
        }
    }{
        s_{lp}^{2.8}
    }
    B_3
}\nonumber
\end{align}

We let, 
\begin{align}
\schw_{lp}
&:=
log
\lr{
\facto{
    \leng
}{
    n_{lp}
}
}\\
\schw^{*}_{lp}
&:=
log
\lr{
\facto{
    \leng^{*}
}{
    n_{lp}^{*}
}
}
\end{align}

Therefore 
$
\schw_{lp}
$ 
is approximated to be,

\begin{equation}
    Stirl{
        \lrb{
            \leng
        }
    }
-
    Stirl{
        \lrb{
            n_{lp}
        }
    }
-
    Stirl{
        \lrb{
            \leng
            -
            n_{lp}
        }
    }
\end{equation}

the expansion is,

\begin{equation}
\lrb{
    \stirl{
        \leng
    }
}
-
\lrb{
    \stirl{
        n_{lp}
    }
}
-
\lrb{
    \stirl{
        \leng
        -
        n_{lp}
    }
},
\end{equation}

and 
$
\schw^{*}_{lp}
$ 
is approximately,

\begin{equation}
    Stirl{
        \lrb{
            \leng^{*}
        }
    }
-
    Stirl{
        \lrb{
            n_{lp}^{*}
        }
    }
-
    Stirl{
        \lrb{
            \leng^{*}
            -
            n_{lp}^{*}
        }
    }
\end{equation}

the expansion is,

\begin{equation}
\lrb{
    \stirl{
        \leng^{*}
    }
}
-
\lrb{
    \stirl{
        n_{lp}^{*}
    }
}
-
\lrb{
    \stirl{
        \leng^{*}
        -
        n_{lp}^{*}
    }
}
\end{equation}

We then can say that Equation \ref{eq.LogRvol1} becomes,

\begin{align}
log
\lr{
    R_{lp}
}
&=
\lr{n_a+1}   
\schw^{*}
-
\lr{n_a}
\schw
+
\lr{
    \frac{
        r
    }{
        s_{lp}-1
    }
}
\lrb{
    log
    \lr{
        \mu_3
    }
    +
    log
    \lr{
    B_3
    }            
    -
    \lr{3.7}
    log
    \lr{
        s_{lp}
    }
}
\end{align}

% \newpage
% \section{Algorithm}

% \newpage
% \section{Validation}

% \newpage
% \section{Discussion}


% \newpage
% \section{Conclusion}


\newpage
\bibliographystyle{unsrt}
\bibliography{bibliography} % Use sample.bib as the bibliography file


\end{document}